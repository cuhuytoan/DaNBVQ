@{
    var userProfile = (HNM.DataNC.ModelsNC.ModelsDTO.ProfilersDTO)ViewBag.UserProfile;
    var gender = "";
    if (userProfile.Gender != null)
    {
        gender = (bool)userProfile.Gender ? "Nam" : "Nữ";
    }
    else
    {
        gender = "Không xác định";
    }
}

@if (ViewBag.ActiveBlock == null)
{
    <div class="tab-pane fade show active" id="taikhoanprofile" role="tabpanel" aria-labelledby="taikhoanprofile-tab">
        <div class="bg-white px-3 border-radius d-flex align-items-center pt-3 pt-lg-0">
            <div class="col-7">
                <span class="hello">Xin chào, @userProfile.FullName </span>
                <p>Hãy chú ý bảo vệ tài khoản của mình bằng cách thực hiện đầy đủ các bước theo hướng dẫn của Hanoma, và đặc biệt đừng chia sẻ tài khoản của mình với người khác nhé!</p>
            </div>
            <div class="col-5">
                <img src="~/images/protect.png" />
            </div>
        </div>
        <div class="bg-white mt-3 border-radius non-editable p-2 px-md-5 py-md-5 pt-5">
            <div class="title-page pb-4 mb-4">
                <h5 class="text-uppercase  font-weight-bold">THÔNG TIN CỦA BẠN</h5>
            </div>
            <div class="content-page info-profile">
                <form id="update-profile" method="post">
                    <div class="form-group row align-items-center mx-0">
                        <label class="col-sm-12 col-12 col-md-12 col-lg-3 col-form-label"><span class="icon-lable name"></span> Họ và tên:</label>
                        <div class="col-sm-8 col-8 col-md-8 col-lg-6">
                            <input type="text" name="FullName" id="FullName" readonly class="form-control" value="@userProfile.FullName">
                        </div>
                        <div class=" col-sm-4 col-4 col-md-4 col-lg-3 px-0 text-right">
                            <span class="edit" onclick="javascript:edit('FullName')">Chỉnh sửa</span>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mx-0">
                        <label class="col-sm-12 col-12 col-md-12 col-lg-3 col-form-label"><span class="icon-lable sex"></span> Giới tính:</label>
                        <div class="col-sm-8 col-8 col-md-8 col-lg-6">
                            <input type="text" name="Gender" id="Gender" readonly class="form-control" value="@gender">
                        </div>
                        <div class=" col-sm-4 col-4 col-md-4 col-lg-3 px-0 text-right">
                            <span class="edit" onclick="javascript:edit('Gender')">Chỉnh sửa</span>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mx-0">
                        <label class="col-sm-12 col-12 col-md-12 col-lg-3 col-form-label"><span class="icon-lable phone"></span> Số điện thoại:</label>
                        <div class="col-sm-8 col-8 col-md-8 col-lg-6">
                            <input type="text" name="Phone" id="Phone" readonly class="form-control" value="@userProfile.Phone">
                        </div>
                        <div class=" col-sm-4 col-4 col-md-4 col-lg-3 px-0 text-right">
                            <span class="edit" onclick="javascript:edit('Phone')">Chỉnh sửa</span>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mx-0">
                        <label class="col-sm-12 col-12 col-md-12 col-lg-3 col-form-label"><span class="icon-lable email"></span> Email:</label>
                        <div class="col-sm-8 col-8 col-md-8 col-lg-6">
                            <input type="text" name="Email" id="Email" readonly class="form-control" value="@userProfile.Email">
                        </div>
                        <div class=" col-sm-4 col-4 col-md-4 col-lg-3 px-0 text-right">
                            <span class="edit" onclick="javascript:edit('Email')">Chỉnh sửa</span>
                        </div>
                    </div>

                    <div class="col-auto justify-content-end d-flex pr-0">
                        <button type="button" onclick="Update()" class="btn btn-primary mb-2">Cập nhật</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
}
else
{
    <div class="tab-pane fade" id="taikhoanprofile" role="tabpanel" aria-labelledby="taikhoanprofile-tab">
        <div class="bg-white px-3 border-radius d-flex align-items-center pt-3 pt-lg-0">
            <div class="col-7">
                <span class="hello">Xin chào, @userProfile.FullName </span>
                <p>Hãy chú ý bảo vệ tài khoản của mình bằng cách thực hiện đầy đủ các bước theo hướng dẫn của Hanoma, và đặc biệt đừng chia sẻ tài khoản của mình với người khác nhé!</p>
            </div>
            <div class="col-5">
                <img src="~/images/protect.png" />
            </div>
        </div>
        <div class="bg-white mt-3 border-radius non-editable p-2 px-md-5 py-md-5 pt-5">
            <div class="title-page pb-4 mb-4">
                <h5 class="text-uppercase  font-weight-bold">THÔNG TIN CỦA BẠN</h5>
            </div>
            <div class="content-page info-profile">
                <form id="update-profile" method="post">
                    <div class="form-group row align-items-center mx-0">
                        <label class="col-sm-12 col-12 col-md-12 col-lg-3 col-form-label"><span class="icon-lable name"></span> Họ và tên:</label>
                        <div class="col-sm-8 col-8 col-md-8 col-lg-6">
                            <input type="text" name="FullName" id="FullName" readonly class="form-control" value="@userProfile.FullName">
                        </div>
                        <div class=" col-sm-4 col-4 col-md-4 col-lg-3 px-0 text-right">
                            <span class="edit" onclick="javascript:edit('FullName')">Chỉnh sửa</span>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mx-0">
                        <label class="col-sm-12 col-12 col-md-12 col-lg-3 col-form-label"><span class="icon-lable sex"></span> Giới tính:</label>
                        <div class="col-sm-8 col-8 col-md-8 col-lg-6">
                            <input type="text" name="Gender" id="Gender" readonly class="form-control" value="@gender">
                        </div>
                        <div class=" col-sm-4 col-4 col-md-4 col-lg-3 px-0 text-right">
                            <span class="edit" onclick="javascript:edit('Gender')">Chỉnh sửa</span>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mx-0">
                        <label class="col-sm-12 col-12 col-md-12 col-lg-3 col-form-label"><span class="icon-lable phone"></span> Số điện thoại:</label>
                        <div class="col-sm-8 col-8 col-md-8 col-lg-6">
                            <input type="text" name="Phone" id="Phone" readonly class="form-control" value="@userProfile.Phone">
                        </div>
                        <div class=" col-sm-4 col-4 col-md-4 col-lg-3 px-0 text-right">
                            <span class="edit" onclick="javascript:edit('Phone')">Chỉnh sửa</span>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mx-0">
                        <label class="col-sm-12 col-12 col-md-12 col-lg-3 col-form-label"><span class="icon-lable email"></span> Email:</label>
                        <div class="col-sm-8 col-8 col-md-8 col-lg-6">
                            <input type="text" name="Email" id="Email" readonly class="form-control" value="@userProfile.Email">
                        </div>
                        <div class=" col-sm-4 col-4 col-md-4 col-lg-3 px-0 text-right">
                            <span class="edit" onclick="javascript:edit('Email')">Chỉnh sửa</span>
                        </div>
                    </div>

                    <div class="col-auto justify-content-end d-flex pr-0">
                        <button type="button" onclick="Update()" class="btn btn-primary mb-2">Cập nhật</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
}


<script>
    function Update() {
        var intGender = 0;
        var userId = "@userProfile.UserId";
        var name = $("#FullName").val();
        var gender = $("#Gender").val();
        if (gender == "Nam") {
            intGender = true;
        }
        else {
            intGender = false
        }
        var phone = $("#Phone").val();
        var email = $("#Email").val();

        $.ajax({
            type: "PUT",
            url: "/Profile/UpdateUser?UserId="+userId+"&FullName=" + name + "&Gender=" + intGender + "&Phone=" + phone + "&Email=" + email,
            dataType: "html",
            success: function (response) {
                var result = JSON.parse(response);
                if (result.ErrorCode == "00") {
                    toastr["success"](result.Message);
                    window.location.href = "/tai-khoan";
                }
                else {
                    toastr["error"](result.Message);
                    window.location.href = "/tai-khoan";
                }
            },
            failure: function (response) {
                alert(response.responseText);
            },
            error: function (response) {
                alert(response.responseText);
            }
        });
    }
</script>